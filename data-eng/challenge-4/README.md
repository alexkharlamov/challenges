## Background
There is a table, PAYMENT, with at least the following columns:
* payment_id
* user_id
* create_dt

Notes about the data:
* Once a single payment comes in from a user, they are now active
* Active users are “at-risk” if we have not received a payment from them in over X days
* X starts at 180 but is subject to change
* No updates are done after the payment has been created


## Challenge
You need to find out which active users were at-risk *_AS OF_* different dates.
For example, if a user had a payment on 2019-03-01 and _at-risk_ is defined
as 30 days, then as of 2019-03-31, they are at-risk.
If there is a payment on 2019-04-01, then as-of that date, they are not at-risk.

There are three charts/graphs that will need to be generated:
1. List of users who are at-risk as of end-of-day yesterday
2. List of users who are at-risk as of an arbitrary day where
  at-risk can be defined as an arbitrary number of days since last payment
3. A graph showing number of at-risk users over time

For number 2, assume that the front-end UI with a date picker and a number
picker has already been generated for you and you have access to variables
in any language that will tell you what the user selected.


## Part One
Write code that will generate the data required for accomplishing (1), (2),
and (3) above. It can be a combination of scripting
and SQL queries. Assume that no as-of table was being generated but there
are many payment entries. Thus the point of this part is to generate the
bulk as-of table.

(Bonus 1) Have (1), (2), and (3) be generated by doing different SQL queries
  on the same large table. For (2), assume that the date picked and the
  at-risk number of days picked are variables available in SQL

(Bonus 2) Talk about how you would deploy and run the code on AWS or a similar cloud environment

(Bonus 3) Write your code with Spark. Talk about how you would deploy and run the Spark code.


## Part Two (Bonus)
There is a new requirement:
A list of users who are at-risk right now. This should be put in a separate table from what was used for the above requirements.

Assume there is a streaming bus of new payments and each entry on the bus has:
* create_dt
* user_id
* payment_id

Describe how you would generate the table required to satisfy this requirement and how you would keep it up to date using this streaming bus.

Assume that the payments will stream in quite frequently and the table of at-risk users will also be accessed quite frequently. What are some optimizations you should do
with this in mind?

No need to write code.


## Part Three (Bonus)
There is no streaming bus but they want that functionality so that
part two can be accomplished. Every X seconds, they want new payments from the PAYMENT table put on a streaming bus. Describe how you would accomplish this. What would you tell the DBA in charge of the PAYMENT table to ensure the backend database is not overloaded?
